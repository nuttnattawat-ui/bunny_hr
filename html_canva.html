<!doctype html>
<html lang="th">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HR BUNNYPHONE</title>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&amp;display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Sarabun', sans-serif;
      background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 50%, #f48fb1 100%);
      min-height: 100%;
      height: 100%;
    }

    html {
      height: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
      height: 100%;
      overflow-y: auto;
    }

    .header {
      background: white;
      padding: 20px 30px;
      border-radius: 20px;
      box-shadow: 0 4px 20px rgba(244, 143, 177, 0.2);
      margin-bottom: 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 15px;
    }

    .header h1 {
      margin: 0;
      color: #d81b60;
      font-size: 32px;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .login-section {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 20px;
      background: #fce4ec;
      border-radius: 25px;
      font-size: 14px;
      color: #d81b60;
      font-weight: 600;
    }

    .login-btn, .logout-btn {
      padding: 10px 25px;
      border: none;
      border-radius: 25px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: 'Sarabun', sans-serif;
    }

    .login-btn {
      background: #d81b60;
      color: white;
    }

    .login-btn:hover {
      background: #c2185b;
      transform: translateY(-2px);
    }

    .logout-btn {
      background: #ec407a;
      color: white;
    }

    .logout-btn:hover {
      background: #d81b60;
    }

    .login-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      overflow-y: auto;
      padding: 20px;
    }

    .login-modal.active {
      display: flex;
    }

    .login-box {
      background: white;
      padding: 40px;
      border-radius: 25px;
      width: 90%;
      max-width: 420px;
      max-height: 90vh;
      overflow-y: auto;
    }

    .login-box h2 {
      margin: 0 0 30px 0;
      color: #d81b60;
      text-align: center;
      font-size: 28px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #333;
      font-weight: 600;
    }

    .form-group input, .form-group textarea, .form-group select {
      width: 100%;
      padding: 12px;
      border: 2px solid #f8bbd0;
      border-radius: 15px;
      font-family: 'Sarabun', sans-serif;
    }

    .form-group input:focus, .form-group textarea:focus, .form-group select:focus {
      outline: none;
      border-color: #d81b60;
    }

    .form-group textarea {
      resize: vertical;
      min-height: 60px;
    }

    .login-buttons {
      display: flex;
      gap: 12px;
      margin-top: 25px;
    }

    .login-buttons button {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 15px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Sarabun', sans-serif;
    }

    .btn-login-submit {
      background: #d81b60;
      color: white;
    }

    .btn-login-cancel {
      background: #f8bbd0;
      color: #d81b60;
    }

    .nav-tabs {
      display: flex;
      gap: 12px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .nav-tab {
      padding: 14px 24px;
      background: white;
      border: none;
      border-radius: 20px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
      color: #666;
      transition: all 0.3s;
      font-family: 'Sarabun', sans-serif;
    }

    .nav-tab:hover {
      transform: translateY(-2px);
    }

    .nav-tab.active {
      background: linear-gradient(135deg, #d81b60 0%, #ec407a 100%);
      color: white;
    }

    .page {
      display: none;
      background: white;
      padding: 35px;
      border-radius: 25px;
    }

    .page.active {
      display: block;
    }

    .page h2 {
      margin: 0 0 30px 0;
      color: #d81b60;
      font-size: 26px;
      font-weight: 700;
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .form-field {
      display: flex;
      flex-direction: column;
    }

    .form-field label {
      margin-bottom: 8px;
      color: #555;
      font-weight: 600;
    }

    .form-field input,
    .form-field select,
    .form-field textarea {
      padding: 12px;
      border: 2px solid #f8bbd0;
      border-radius: 12px;
      font-family: 'Sarabun', sans-serif;
    }

    .form-field input:focus,
    .form-field select:focus,
    .form-field textarea:focus {
      outline: none;
      border-color: #d81b60;
    }

    .form-field textarea {
      resize: vertical;
      min-height: 90px;
    }

    .btn-primary {
      padding: 14px 35px;
      background: linear-gradient(135deg, #d81b60 0%, #ec407a 100%);
      color: white;
      border: none;
      border-radius: 15px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 15px;
      font-family: 'Sarabun', sans-serif;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 25px;
    }

    .data-table thead {
      background: linear-gradient(135deg, #d81b60 0%, #ec407a 100%);
      color: white;
    }

    .data-table th {
      padding: 16px;
      text-align: left;
      font-weight: 600;
    }

    .data-table td {
      padding: 14px 16px;
      border-bottom: 1px solid #fce4ec;
    }

    .data-table tbody tr:hover {
      background: #fce4ec;
    }

    .btn-icon {
      padding: 8px 14px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-family: 'Sarabun', sans-serif;
      margin-right: 5px;
    }

    .btn-edit {
      background: #42a5f5;
      color: white;
    }

    .btn-delete {
      background: #ec407a;
      color: white;
    }

    .btn-approve {
      background: #66bb6a;
      color: white;
    }

    .btn-reject {
      background: #ef5350;
      color: white;
    }

    .info-box {
      background: #e3f2fd;
      border-left: 4px solid #42a5f5;
      padding: 20px;
      border-radius: 12px;
      margin: 25px 0;
    }

    .info-box h4 {
      margin: 0 0 10px 0;
      color: #1565c0;
    }

    .info-box a {
      color: #1976d2;
      text-decoration: none;
      font-weight: 600;
    }

    .calendar-container {
      margin-top: 30px;
    }

    .calendar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding: 20px;
      background: #fce4ec;
      border-radius: 15px;
    }

    .calendar-header h3 {
      margin: 0;
      color: #d81b60;
      font-size: 22px;
    }

    .calendar-nav button {
      padding: 10px 18px;
      background: #d81b60;
      color: white;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      font-family: 'Sarabun', sans-serif;
      margin-left: 10px;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }

    .calendar-day-header {
      padding: 12px;
      text-align: center;
      font-weight: 700;
      color: #d81b60;
      background: #fce4ec;
      border-radius: 8px;
    }

    .calendar-day {
      min-height: 100px;
      padding: 8px;
      background: #fafafa;
      border-radius: 8px;
      border: 1px solid #f0f0f0;
    }

    .calendar-day-number {
      font-weight: 700;
      color: #d81b60;
      margin-bottom: 6px;
    }

    .calendar-event {
      padding: 4px 8px;
      background: #d81b60;
      color: white;
      border-radius: 6px;
      font-size: 11px;
      margin-bottom: 4px;
      cursor: pointer;
    }

    .calendar-event.shift {
      background: #42a5f5;
    }

    .calendar-event.leave {
      background: #ff9800;
    }

    .status-badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .status-pending {
      background: #fff3e0;
      color: #f57c00;
    }

    .status-approved {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .status-rejected {
      background: #ffebee;
      color: #c62828;
    }

    .profile-header {
      display: flex;
      align-items: center;
      gap: 30px;
      padding: 30px;
      background: linear-gradient(135deg, #fce4ec 0%, #f8bbd0 100%);
      border-radius: 20px;
      margin-bottom: 30px;
    }

    .profile-photo {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
      border: 5px solid white;
    }

    .timeline {
      position: relative;
      padding-left: 40px;
      margin-top: 30px;
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 15px;
      top: 0;
      bottom: 0;
      width: 3px;
      background: #f8bbd0;
    }

    .timeline-item {
      position: relative;
      margin-bottom: 30px;
      padding: 20px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 2px 10px rgba(244, 143, 177, 0.1);
    }

    .timeline-item::before {
      content: '';
      position: absolute;
      left: -32px;
      top: 25px;
      width: 15px;
      height: 15px;
      background: #d81b60;
      border-radius: 50%;
      border: 3px solid white;
    }

    .timeline-type {
      display: inline-block;
      padding: 4px 12px;
      background: #fce4ec;
      color: #d81b60;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .btn-export {
      padding: 10px 20px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      font-family: 'Sarabun', sans-serif;
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #d81b60;
    }

    @media (max-width: 768px) {
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .calendar-grid {
        gap: 4px;
      }
      
      .calendar-day {
        min-height: 80px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <header class="header">
    <h1><span>üê∞</span> <span>HR BUNNYPHONE</span></h1>
    <div class="login-section">
     <div class="user-info" id="user-info" style="display: none;"><span>üë§</span> <span id="current-user">User</span> <span>|</span> <span id="current-role">‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</span>
     </div><button class="login-btn" id="create-user-header-btn" style="margin-right: 10px;">üë§ ‡∏™‡∏£‡πâ‡∏≤‡∏á User ‡πÉ‡∏´‡∏°‡πà</button> <button class="login-btn" id="login-btn">üîê Login</button> <button class="logout-btn" id="logout-btn" style="display: none;">üö™ Logout</button>
    </div>
   </header>
   <div class="nav-tabs" id="nav-tabs"></div>
   <div id="pages-container"><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô -->
    <main class="page" id="page-daily">
     <h2>üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
     <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;"><button class="btn-primary" id="btn-save-daily-to-sheet" style="display: none;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button> <button class="btn-primary" id="btn-load-daily-from-sheet" style="background: #42a5f5;">üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet</button> <button class="btn-primary" id="btn-open-daily-sheet" style="background: #66bb6a;">üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Google Sheet</button>
     </div>
     <div class="form-row" style="grid-template-columns: 1fr 1fr;">
      <div class="form-field"><label for="daily-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="daily-department"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
      <div class="form-field"><label for="daily-employee">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="daily-employee"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
      </div>
     </div>
     <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
      <div class="form-field"><label for="daily-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="daily-date">
      </div>
      <div class="form-field"><label for="daily-leave-type">‡∏ä‡∏ô‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label> <select id="daily-leave-type"> <option value="">‡πÑ‡∏°‡πà‡∏•‡∏≤</option> <option value="‡∏•‡∏≤‡∏Å‡∏¥‡∏à">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</option> <option value="‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</option> <option value="‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</option> </select>
      </div>
      <div class="form-field"><label for="daily-approval">‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</label> <select id="daily-approval"> <option value="">‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</option> <option value="‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</option> <option value="‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô">‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</option> </select>
      </div>
     </div>
     <div class="form-row" style="grid-template-columns: 1fr 1fr 1fr;">
      <div class="form-field"><label for="daily-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label> <select id="daily-status"> <option value="‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô">‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</option> <option value="OT">OT</option> <option value="‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥</option> <option value="‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå">‡∏ô‡∏±‡∏Å‡∏Ç‡∏±‡∏ï‡∏§‡∏Å‡∏©‡πå</option> <option value="‡∏ä‡∏î‡πÄ‡∏ä‡∏¢">‡∏ä‡∏î‡πÄ‡∏ä‡∏¢</option> </select>
      </div>
      <div class="form-field"><label for="daily-shift">‡∏Å‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label> <select id="daily-shift"> <option value="8:00‚Äì17:00">8:00‚Äì17:00</option> <option value="9:00‚Äì18:00">9:00‚Äì18:00</option> <option value="9:00‚Äì19:00">9:00‚Äì19:00</option> <option value="11:00‚Äì21:00">11:00‚Äì21:00</option> <option value="12:00‚Äì21:00">12:00‚Äì21:00</option> <option value="14:00‚Äì23:00">14:00‚Äì23:00</option> <option value="15:00‚Äì00:00">15:00‚Äì00:00</option> <option value="21:00‚Äì07:00">21:00‚Äì07:00</option> <option value="23:00‚Äì09:00">23:00‚Äì09:00</option> <option value="‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥</option> </select>
      </div>
      <div class="form-field"><label for="daily-time">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</label> <input type="time" id="daily-time">
      </div>
     </div>
     <div class="form-row" style="grid-template-columns: 1fr 1fr;">
      <div class="form-field"><label for="daily-late">‡∏™‡∏≤‡∏¢ (‡∏ô‡∏≤‡∏ó‡∏µ)</label> <input type="number" id="daily-late" min="0" value="0">
      </div>
      <div class="form-field"><label for="daily-ot">OT (‡∏ô‡∏≤‡∏ó‡∏µ)</label> <input type="number" id="daily-ot" min="0" value="0">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="daily-note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</label> <textarea id="daily-note"></textarea>
      </div>
     </div><button class="btn-primary" id="btn-save-daily">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
     <table class="data-table">
      <thead>
       <tr>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏ä‡∏ô‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤</th>
        <th>‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
        <th>‡∏Å‡∏∞</th>
        <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
        <th>‡∏™‡∏≤‡∏¢(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
        <th>OT(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
        <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠</th>
        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
       </tr>
      </thead>
      <tbody id="daily-table-body">
       <tr>
        <td colspan="12" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
       </tr>
      </tbody>
     </table>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏Ç‡∏≠‡∏•‡∏≤‡∏á‡∏≤‡∏ô (‡∏£‡∏ß‡∏° 3 ‡∏™‡πà‡∏ß‡∏ô) -->
    <main class="page" id="page-leave-request">
     <h2>üìù ‡∏Ç‡∏≠‡∏•‡∏≤‡∏á‡∏≤‡∏ô</h2><!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤ -->
     <div style="background: #fff3e0; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
      <h3 style="color: #d81b60; margin-top: 0;">üìù ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</h3>
      <div class="form-row">
       <div class="form-field"><label for="leave-req-date-from">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</label> <input type="date" id="leave-req-date-from">
       </div>
       <div class="form-field"><label for="leave-req-date-to">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î</label> <input type="date" id="leave-req-date-to">
       </div>
       <div class="form-field"><label for="leave-req-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="leave-req-department"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
       </div>
       <div class="form-field"><label for="leave-req-employee">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="leave-req-employee"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
       </div>
      </div>
      <div class="form-row">
       <div class="form-field"><label for="leave-req-type">‡∏ä‡∏ô‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label> <select id="leave-req-type"> <option value="‡∏•‡∏≤‡∏Å‡∏¥‡∏à">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</option> <option value="‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</option> <option value="‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</option> <option value="‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏î‡πÄ‡∏ä‡∏¢">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏ä‡∏î‡πÄ‡∏ä‡∏¢</option> </select>
       </div>
       <div class="form-field"><label for="leave-req-note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ / ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label> <textarea id="leave-req-note"></textarea>
       </div>
      </div><button class="btn-primary" id="btn-save-leave-req">üìù ‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤</button>
     </div><!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ -->
     <div style="background: #e8f5e9; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
      <h3 style="color: #d81b60; margin-top: 0;">üïì ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</h3>
      <table class="data-table">
       <thead>
        <tr>
         <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th>
         <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
         <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠</th>
         <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤(‡∏à‡∏≤‡∏Å)</th>
         <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤(‡∏ñ‡∏∂‡∏á)</th>
         <th>‡∏ß‡∏±‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤</th>
         <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
         <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
         <th id="approval-actions-header">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
        </tr>
       </thead>
       <tbody id="combined-pending-table">
        <tr>
         <td colspan="9" class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td>
        </tr>
       </tbody>
      </table>
     </div><!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏≤ -->
     <div style="background: #f3e5f5; padding: 25px; border-radius: 15px;">
      <h3 style="color: #d81b60; margin-top: 0;">üìò ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏•‡∏≤</h3>
      <div style="line-height: 1.9; color: #333;">
       <h4 style="color: #d81b60; margin-top: 20px;">üîπ ‡∏•‡∏≤‡∏Å‡∏¥‡∏à (3 ‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ)</h4>
       <ul>
        <li>‡πÉ‡∏ä‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ò‡∏∏‡∏£‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</li>
        <li><strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:</strong> ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ <strong>1 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£</strong></li>
        <li>‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Lead ‡∏´‡∏£‡∏∑‡∏≠ HR</li>
       </ul>
       <h4 style="color: #d81b60; margin-top: 20px;">üîπ ‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô (6 ‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ)</h4>
       <ul>
        <li>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô‡∏ï‡∏≤‡∏°‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ</li>
        <li><strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤:</strong></li>
        <ul style="margin-left: 20px;">
         <li>‡∏•‡∏≤ 1-3 ‡∏ß‡∏±‡∏ô: ‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ <strong>7 ‡∏ß‡∏±‡∏ô</strong></li>
         <li>‡∏•‡∏≤ 4-5 ‡∏ß‡∏±‡∏ô: ‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ <strong>14 ‡∏ß‡∏±‡∏ô</strong></li>
         <li>‡∏•‡∏≤ 6 ‡∏ß‡∏±‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ: ‡πÅ‡∏à‡πâ‡∏á‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ <strong>20 ‡∏ß‡∏±‡∏ô</strong></li>
        </ul>
       </ul>
       <h4 style="color: #d81b60; margin-top: 20px;">üîπ ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢ (30 ‡∏ß‡∏±‡∏ô/‡∏õ‡∏µ)</h4>
       <ul>
        <li>‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πá‡∏ö‡∏õ‡πà‡∏ß‡∏¢‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ</li>
        <li><strong>‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç:</strong></li>
        <ul style="margin-left: 20px;">
         <li>‡∏•‡∏≤ <strong>1 ‡∏ß‡∏±‡∏ô</strong>: ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå</li>
         <li>‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô <strong>1 ‡∏ß‡∏±‡∏ô</strong>: ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡πÅ‡∏û‡∏ó‡∏¢‡πå</li>
        </ul>
       </ul>
       <h3 style="margin-top: 40px; color: #d81b60;">üìù ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏•‡∏≤</h3>
       <ol>
        <li>‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏•‡∏≤‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏°‡∏ô‡∏π <strong>"‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤"</strong></li>
        <li>‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏≤ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤ ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•</li>
        <li>‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Lead ‡∏´‡∏£‡∏∑‡∏≠ HR</li>
        <li>‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π <strong>"‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥"</strong></li>
       </ol>
      </div>
     </div>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô -->
    <main class="page" id="page-report">
     <h2>üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</h2>
     <div style="display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; align-items: flex-end;">
      <div class="form-field"><label for="report-date-from">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="report-date-from">
      </div>
      <div class="form-field"><label for="report-date-to">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="report-date-to">
      </div>
      <div class="form-field"><label for="report-mode">‡πÇ‡∏´‡∏°‡∏î‡∏î‡∏π</label> <select id="report-mode"> <option value="department">‡∏£‡∏≤‡∏¢‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="individual">‡∏£‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</option> </select>
      </div>
      <div class="form-field"><label for="report-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="report-department"> <option value="">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
      <div class="form-field" id="report-employee-field" style="display: none;"><label for="report-employee">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="report-employee"> <option value="">‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</option> </select>
      </div><button class="btn-primary" id="btn-generate-report">üîç ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
     </div>
     <table class="data-table">
      <thead id="report-table-head">
       <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
        <th>‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô(‡∏ß‡∏±‡∏ô)</th>
        <th>OT(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
        <th>‡∏™‡∏≤‡∏¢(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
        <th>‡∏•‡∏≤‡∏Å‡∏¥‡∏à(‡∏ß‡∏±‡∏ô)</th>
        <th>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢(‡∏ß‡∏±‡∏ô)</th>
        <th>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô(‡∏ß‡∏±‡∏ô)</th>
        <th>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</th>
        <th>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
        <th>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</th>
       </tr>
      </thead>
      <tbody id="report-table-body">
       <tr>
        <td colspan="10" class="empty-state">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</td>
       </tr>
      </tbody>
     </table>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏∞‡∏á‡∏≤‡∏ô -->
    <main class="page" id="page-calendar">
     <h2>üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏∞‡∏á‡∏≤‡∏ô</h2>
     <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;"><button class="btn-primary" id="btn-save-shift-to-sheet" style="display: none;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button> <button class="btn-primary" id="btn-load-shift-from-sheet" style="background: #42a5f5;">üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet</button> <button class="btn-primary" id="btn-open-shift-sheet" style="background: #66bb6a;">üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Google Sheet</button>
     </div>
     <div id="admin-shift-form" style="display: none;">
      <h3 style="color: #d81b60; margin-bottom: 20px;">‡∏•‡∏á‡∏Å‡∏∞‡∏á‡∏≤‡∏ô</h3>
      <div class="form-row">
       <div class="form-field"><label for="shift-date-from">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏à‡∏≤‡∏Å)</label> <input type="date" id="shift-date-from">
       </div>
       <div class="form-field"><label for="shift-date-to">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏ñ‡∏∂‡∏á)</label> <input type="date" id="shift-date-to">
       </div>
       <div class="form-field"><label for="shift-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="shift-department"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
       </div>
       <div class="form-field"><label for="shift-employee">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="shift-employee"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
       </div>
      </div>
      <div class="form-row">
       <div class="form-field"><label for="shift-shift">‡∏Å‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label> <select id="shift-shift"> <option value="8:00‚Äì17:00">8:00‚Äì17:00</option> <option value="9:00‚Äì18:00">9:00‚Äì18:00</option> <option value="9:00‚Äì19:00">9:00‚Äì19:00</option> <option value="11:00‚Äì21:00">11:00‚Äì21:00</option> <option value="12:00‚Äì21:00">12:00‚Äì21:00</option> <option value="14:00‚Äì23:00">14:00‚Äì23:00</option> <option value="15:00‚Äì00:00">15:00‚Äì00:00</option> <option value="21:00‚Äì07:00">21:00‚Äì07:00</option> <option value="23:00‚Äì09:00">23:00‚Äì09:00</option> <option value="‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥</option> </select>
       </div>
       <div class="form-field"><label for="shift-note">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label> <input type="text" id="shift-note">
       </div>
      </div><button class="btn-primary" id="btn-save-shift">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏∞‡∏á‡∏≤‡∏ô</button>
      <hr style="margin: 40px 0; border: none; border-top: 2px dashed #f8bbd0;">
     </div>
     <div style="margin-bottom: 20px;"><label for="calendar-filter-department">‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡πÅ‡∏ú‡∏ô‡∏Å:</label> <select id="calendar-filter-department" style="padding: 10px; border-radius: 10px; border: 2px solid #f8bbd0; margin-left: 10px;"> <option value="">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
     </div>
     <div class="calendar-container">
      <div class="calendar-header">
       <h3 id="calendar-month-year"></h3>
       <div class="calendar-nav"><button id="btn-prev-month">‚óÄ ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô</button> <button id="btn-today">‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</button> <button id="btn-next-month">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ñ∂</button>
       </div>
      </div>
      <div class="calendar-grid" id="calendar-grid"></div>
     </div>
     <h3 style="color: #d81b60; margin-top: 40px; margin-bottom: 20px;">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏∞‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏≤</h3>
     <table class="data-table">
      <thead>
       <tr>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
        <th>‡∏Å‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</th>
        <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤ (‡∏à‡∏≤‡∏Å‚Äì‡∏ñ‡∏∂‡∏á)</th>
        <th>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢</th>
        <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
       </tr>
      </thead>
      <tbody id="calendar-summary-table">
       <tr>
        <td colspan="7" class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
       </tr>
      </tbody>
     </table>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏™‡∏£‡πâ‡∏≤‡∏á User ‡πÉ‡∏´‡∏°‡πà -->
    <main class="page" id="page-create-user">
     <h2>üë§ ‡∏™‡∏£‡πâ‡∏≤‡∏á User ‡πÉ‡∏´‡∏°‡πà</h2>
     <div class="form-row">
      <div class="form-field"><label for="new-username">Username</label> <input type="text" id="new-username" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Username">
      </div>
      <div class="form-field"><label for="new-password">Password</label> <input type="password" id="new-password" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="new-fullname">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label> <input type="text" id="new-fullname">
      </div>
      <div class="form-field"><label for="new-nickname">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label> <input type="text" id="new-nickname">
      </div>
      <div class="form-field"><label for="new-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="new-department"> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="new-birthday">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label> <input type="date" id="new-birthday">
      </div>
      <div class="form-field"><label for="new-bank">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label> <input type="text" id="new-bank">
      </div>
      <div class="form-field"><label for="new-account">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</label> <input type="text" id="new-account">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="new-email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label> <input type="email" id="new-email">
      </div>
      <div class="form-field"><label for="new-address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label> <textarea id="new-address"></textarea>
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="new-emergency-contact">‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</label> <input type="text" id="new-emergency-contact">
      </div>
      <div class="form-field"><label for="new-emergency-relationship">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</label> <input type="text" id="new-emergency-relationship">
      </div>
      <div class="form-field"><label for="new-emergency-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label> <input type="tel" id="new-emergency-phone">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="new-photo">URL ‡∏£‡∏π‡∏õ Profile</label> <input type="url" id="new-photo" placeholder="https://...">
      </div>
     </div><button class="btn-primary" id="btn-create-user">üíæ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ User</button>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô -->
    <main class="page" id="page-manage">
     <h2>üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h2>
     <div class="form-row">
      <div class="form-field"><label for="emp-fullname">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label> <select id="emp-fullname"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
      </div>
      <div class="form-field"><label for="emp-nickname">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label> <input type="text" id="emp-nickname">
      </div>
      <div class="form-field"><label for="emp-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="emp-department"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-username">Username</label> <input type="text" id="emp-username">
      </div>
      <div class="form-field"><label for="emp-password">Password</label> <input type="text" id="emp-password">
      </div>
      <div class="form-field"><label for="emp-position">‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</label> <input type="text" id="emp-position">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-birthday">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label> <input type="date" id="emp-birthday">
      </div>
      <div class="form-field"><label for="emp-dayoff">‡∏ß‡∏±‡∏ô‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∞‡∏à‡∏≥</label> <input type="text" id="emp-dayoff" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå-‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£">
      </div>
      <div class="form-field"><label for="emp-bank">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label> <input type="text" id="emp-bank">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-account">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</label> <input type="text" id="emp-account">
      </div>
      <div class="form-field"><label for="emp-email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label> <input type="email" id="emp-email">
      </div>
      <div class="form-field"><label for="emp-address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label> <textarea id="emp-address"></textarea>
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-emergency-contact">‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</label> <input type="text" id="emp-emergency-contact">
      </div>
      <div class="form-field"><label for="emp-emergency-relationship">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</label> <input type="text" id="emp-emergency-relationship">
      </div>
      <div class="form-field"><label for="emp-emergency-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</label> <input type="tel" id="emp-emergency-phone">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-photo">URL ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢</label> <input type="url" id="emp-photo">
      </div>
      <div class="form-field"><label for="emp-idcard">URL ‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label> <input type="url" id="emp-idcard">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-application">URL ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏á‡∏≤‡∏ô</label> <input type="url" id="emp-application">
      </div>
      <div class="form-field"><label for="emp-contract">URL ‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏à‡πâ‡∏≤‡∏á</label> <input type="url" id="emp-contract">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="emp-startdate">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô</label> <input type="date" id="emp-startdate">
      </div>
      <div class="form-field"><label for="emp-status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô</label> <select id="emp-status"> <option value="‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà">‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà</option> <option value="‡∏û‡πâ‡∏ô‡∏™‡∏†‡∏≤‡∏û">‡∏û‡πâ‡∏ô‡∏™‡∏†‡∏≤‡∏û</option> </select>
      </div>
     </div><button class="btn-primary" id="btn-save-employee">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
     <h3 style="margin-top: 40px; color: #d81b60;">üìã ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
     <table class="data-table">
      <thead>
       <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</th>
        <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
        <th>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</th>
        <th>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</th>
        <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
       </tr>
      </thead>
      <tbody id="employee-table-body">
       <tr>
        <td colspan="7" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td>
       </tr>
      </tbody>
     </table>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: Profile -->
    <main class="page" id="page-profile">
     <h2>üìá Profile (Digital Employee Profile)</h2>
     <div style="display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; align-items: flex-end;">
      <div class="form-field"><label for="profile-date-from">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="profile-date-from">
      </div>
      <div class="form-field"><label for="profile-date-to">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="profile-date-to">
      </div>
      <div class="form-field"><label for="profile-employee">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="profile-employee"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
      </div><button class="btn-primary" id="btn-load-profile">üîç ‡πÇ‡∏´‡∏•‡∏î Profile</button> <button class="btn-export" id="btn-export-profile" style="display: none;">üì• Export to Google Sheet</button>
     </div>
     <div id="profile-content" style="display: none;">
      <div class="profile-header"><img src="" alt="Profile Photo" class="profile-photo" id="profile-photo">
       <div class="profile-info">
        <h3 id="profile-name">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</h3>
        <p><strong>‡πÅ‡∏ú‡∏ô‡∏Å:</strong> <span id="profile-dept"></span></p>
        <p><strong>‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á:</strong> <span id="profile-pos"></span></p>
        <p><strong>‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î:</strong> <span id="profile-bday"></span></p>
        <p><strong>‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô:</strong> <span id="profile-start"></span></p>
       </div>
      </div>
      <h3 style="color: #d81b60; margin-top: 30px;">üìã Timeline</h3>
      <div class="timeline" id="profile-timeline">
       <div class="empty-state">
        ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Timeline
       </div>
      </div>
     </div>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <main class="page" id="page-warning">
     <h2>‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>
     <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;"><button class="btn-primary" id="btn-save-warning-to-sheet" style="display: none;">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button> <button class="btn-primary" id="btn-load-warning-from-sheet" style="background: #42a5f5;">üì• ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet</button> <button class="btn-primary" id="btn-open-warning-sheet" style="background: #66bb6a;">üìä ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Google Sheet</button>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="warning-date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="warning-date">
      </div>
      <div class="form-field"><label for="warning-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="warning-department"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
      <div class="form-field"><label for="warning-employee">‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="warning-employee"> <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option> </select>
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="warning-subject">‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</label> <input type="text" id="warning-subject">
      </div>
      <div class="form-field"><label for="warning-by">‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢</label> <input type="text" id="warning-by">
      </div>
     </div>
     <div class="form-row">
      <div class="form-field"><label for="warning-detail">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label> <textarea id="warning-detail"></textarea>
      </div>
     </div><button class="btn-primary" id="btn-save-warning">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
     <h3 style="margin-top: 40px; color: #d81b60;">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
     <table class="data-table">
      <thead>
       <tr>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡πÅ‡∏ú‡∏ô‡∏Å</th>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
        <th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</th>
        <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
        <th>‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢</th>
        <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
       </tr>
      </thead>
      <tbody id="warning-table-body">
       <tr>
        <td colspan="7" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
       </tr>
      </tbody>
     </table>
    </main><!-- ‡∏´‡∏ô‡πâ‡∏≤: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô -->
    <main class="page" id="page-warning-report">
     <h2>üìë ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>
     <div style="display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; align-items: flex-end;">
      <div class="form-field"><label for="warning-report-date-from">‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="warning-report-date-from">
      </div>
      <div class="form-field"><label for="warning-report-date-to">‡∏ñ‡∏∂‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label> <input type="date" id="warning-report-date-to">
      </div>
      <div class="form-field"><label for="warning-report-department">‡πÅ‡∏ú‡∏ô‡∏Å</label> <select id="warning-report-department"> <option value="">‡∏ó‡∏∏‡∏Å‡πÅ‡∏ú‡∏ô‡∏Å</option> <option value="Admin&amp;Coordinator">Admin&amp;Coordinator</option> <option value="Sale">Sale</option> <option value="Bunny Man">Bunny Man</option> <option value="QC">QC</option> <option value="Stock">Stock</option> <option value="Operation">Operation</option> <option value="In House Bunny Man">In House Bunny Man</option> </select>
      </div>
      <div class="form-field"><label for="warning-report-employee">‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</label> <select id="warning-report-employee"> <option value="">‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</option> </select>
      </div><button class="btn-primary" id="btn-generate-warning-report">üîç ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</button>
     </div>
     <table class="data-table">
      <thead>
       <tr>
        <th>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
        <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
        <th>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</th>
        <th>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</th>
        <th>‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢</th>
       </tr>
      </thead>
      <tbody id="warning-report-table-body">
       <tr>
        <td colspan="5" class="empty-state">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</td>
       </tr>
      </tbody>
     </table>
    </main>
   </div><!-- Login Modal -->
   <div class="login-modal" id="login-modal">
    <div class="login-box">
     <h2>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h2>
     <div class="form-group"><label for="login-username">Username</label> <input type="text" id="login-username">
     </div>
     <div class="form-group"><label for="login-password">Password</label> <input type="password" id="login-password">
     </div>
     <div class="login-buttons"><button class="btn-login-submit" id="btn-login-submit">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button> <button class="btn-login-cancel" id="btn-login-cancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
     </div>
    </div>
   </div>
  </div>
  <script>
    const STATIC_USERS = {
      'Admin': { password: 'AaAa2538', role: 'admin', displayName: 'Admin' },
      'Hrpairwa': { password: 'Pair1234', role: 'hr', displayName: 'HR Pairwa' },
      'Hrnut': { password: 'Nut1234', role: 'hr', displayName: 'HR Nut' },
      'Leadgun': { password: 'Gun1234', role: 'lead', displayName: 'Lead Gun' },
      'Leadred': { password: 'Red1234', role: 'lead', displayName: 'Lead Red' }
    };

    const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbwL8BYXmKLQRj2iWKhqanprId6lr3QfghiEb0Y3BzrZigEPf34xdy6Xk4wwMkS3R-2I/exec';

    let currentUser = null;
    let currentRole = 'user';
    let currentUsername = null;
    let allRecords = [];
    let currentCalendarDate = new Date();
    let currentEditingUserId = null;

    const dataHandler = {
      onDataChanged(data) {
        allRecords = data;
        refreshCurrentPage();
      }
    };

    async function init() {
      const result = await window.dataSdk.init(dataHandler);
      if (!result.isOk) {
        console.error('Failed to initialize');
        return;
      }

      setupLoginHandlers();
      setupNavigation();
      setupEventHandlers();
      setTodayDates();
      showPage('calendar');
    }

    function setupLoginHandlers() {
      document.getElementById('login-btn').addEventListener('click', () => {
        document.getElementById('login-modal').classList.add('active');
      });

      document.getElementById('btn-login-cancel').addEventListener('click', () => {
        document.getElementById('login-modal').classList.remove('active');
      });

      document.getElementById('btn-login-submit').addEventListener('click', handleLogin);
      document.getElementById('logout-btn').addEventListener('click', handleLogout);
      
      document.getElementById('create-user-header-btn').addEventListener('click', openCreateUserModal);
    }

    function openCreateUserModal() {
      document.getElementById('login-modal').classList.remove('active');
      
      const createUserModal = document.createElement('div');
      createUserModal.className = 'login-modal active';
      createUserModal.id = 'create-user-modal';
      createUserModal.innerHTML = `
        <div class="login-box" style="max-width: 700px; max-height: 90vh; overflow-y: auto;">
          <h2>üë§ ‡∏™‡∏£‡πâ‡∏≤‡∏á User ‡πÉ‡∏´‡∏°‡πà</h2>
          
          <div class="form-group">
            <label for="modal-username">Username</label>
            <input type="text" id="modal-username" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ Username">
          </div>
          <div class="form-group">
            <label for="modal-password">Password</label>
            <input type="password" id="modal-password" placeholder="‡∏ï‡∏±‡πâ‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
          </div>
          <div class="form-group">
            <label for="modal-fullname">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
            <input type="text" id="modal-fullname">
          </div>
          <div class="form-group">
            <label for="modal-nickname">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô</label>
            <input type="text" id="modal-nickname">
          </div>
          <div class="form-group">
            <label for="modal-department">‡πÅ‡∏ú‡∏ô‡∏Å</label>
            <select id="modal-department">
              <option value="Admin&Coordinator">Admin&Coordinator</option>
              <option value="Sale">Sale</option>
              <option value="Bunny Man">Bunny Man</option>
              <option value="QC">QC</option>
              <option value="Stock">Stock</option>
              <option value="Operation">Operation</option>
              <option value="In House Bunny Man">In House Bunny Man</option>
            </select>
          </div>
          <div class="form-group">
            <label for="modal-birthday">‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</label>
            <input type="date" id="modal-birthday">
          </div>
          <div class="form-group">
            <label for="modal-bank">‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</label>
            <input type="text" id="modal-bank">
          </div>
          <div class="form-group">
            <label for="modal-account">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</label>
            <input type="text" id="modal-account">
          </div>
          <div class="form-group">
            <label for="modal-email">‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
            <input type="email" id="modal-email">
          </div>
          <div class="form-group">
            <label for="modal-address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label>
            <textarea id="modal-address" rows="3"></textarea>
          </div>
          <div class="form-group">
            <label for="modal-emergency-contact">‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</label>
            <input type="text" id="modal-emergency-contact">
          </div>
          <div class="form-group">
            <label for="modal-emergency-relationship">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå</label>
            <input type="text" id="modal-emergency-relationship">
          </div>
          <div class="form-group">
            <label for="modal-emergency-phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</label>
            <input type="tel" id="modal-emergency-phone">
          </div>
          <div class="form-group">
            <label for="modal-photo">URL ‡∏£‡∏π‡∏õ Profile</label>
            <input type="url" id="modal-photo" placeholder="https://...">
          </div>
          
          <div class="login-buttons">
            <button class="btn-login-submit" id="btn-modal-create-user">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
            <button class="btn-login-cancel" id="btn-modal-cancel">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          </div>
        </div>
      `;
      
      document.body.appendChild(createUserModal);
      
      document.getElementById('btn-modal-cancel').addEventListener('click', () => {
        createUserModal.remove();
      });
      
      document.getElementById('btn-modal-create-user').addEventListener('click', async () => {
        const username = document.getElementById('modal-username').value.trim();
        const password = document.getElementById('modal-password').value;
        const fullname = document.getElementById('modal-fullname').value;
        const nickname = document.getElementById('modal-nickname').value;
        const department = document.getElementById('modal-department').value;
        
        if (!username || !password || !fullname) {
          Swal.fire({
            icon: 'warning',
            title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
            text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Username, Password ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
            confirmButtonColor: '#d81b60'
          });
          return;
        }
        
        const existingUser = allRecords.find(r => r.type === 'user' && r.username === username);
        if (existingUser) {
          Swal.fire({
            icon: 'error',
            title: 'Username ‡∏ã‡πâ‡∏≥',
            text: 'Username ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß',
            confirmButtonColor: '#d81b60'
          });
          return;
        }
        
        const record = {
          type: 'user',
          username: username,
          password: password,
          employee_fullname: fullname,
          nickname: nickname,
          department: department,
          birthday: document.getElementById('modal-birthday').value,
          bank_name: document.getElementById('modal-bank').value,
          bank_account: document.getElementById('modal-account').value,
          email: document.getElementById('modal-email').value,
          address: document.getElementById('modal-address').value,
          emergency_contact: document.getElementById('modal-emergency-contact').value,
          emergency_relationship: document.getElementById('modal-emergency-relationship').value,
          emergency_phone: document.getElementById('modal-emergency-phone').value,
          photo_url: document.getElementById('modal-photo').value,
          role: 'user',
          id: Date.now().toString()
        };
        
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });
        
        const result = await window.dataSdk.create(record);
        
        if (result.isOk) {
          await sendToGoogleSheet({
            action: 'create_user',
            ...record
          });

          Swal.fire({
            icon: 'success',
            title: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            text: `Username: ${username}`,
            confirmButtonColor: '#d81b60'
          });
          createUserModal.remove();
        } else {
          Swal.fire({
            icon: 'error',
            title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: result.error.message,
            confirmButtonColor: '#d81b60'
          });
        }
      });
    }

    function handleLogin() {
      const username = document.getElementById('login-username').value.trim();
      const password = document.getElementById('login-password').value;

      let user = STATIC_USERS[username];
      let isStaticUser = !!user;

      if (!user) {
        const dynamicUser = allRecords.find(r => r.type === 'user' && r.username === username);
        if (dynamicUser && dynamicUser.password === password) {
          user = {
            password: dynamicUser.password,
            role: 'user',
            displayName: dynamicUser.nickname || dynamicUser.employee_fullname || username
          };
        }
      }

      if (!user || user.password !== password) {
        Swal.fire({
          icon: 'error',
          title: '‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: 'Username ‡∏´‡∏£‡∏∑‡∏≠ Password ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      currentUser = user.displayName;
      currentRole = user.role;
      currentUsername = username;

      document.getElementById('login-modal').classList.remove('active');
      document.getElementById('login-btn').style.display = 'none';
      document.getElementById('logout-btn').style.display = 'block';
      document.getElementById('user-info').style.display = 'flex';
      document.getElementById('current-user').textContent = currentUser;
      document.getElementById('current-role').textContent = getRoleDisplayName(currentRole);

      setupNavigation();
      showPage('leave-request');

      Swal.fire({
        icon: 'success',
        title: '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
        text: `‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö ${currentUser}`,
        timer: 1500,
        showConfirmButton: false
      });
    }

    function handleLogout() {
      currentUser = null;
      currentRole = 'user';
      currentUsername = null;

      document.getElementById('login-btn').style.display = 'block';
      document.getElementById('logout-btn').style.display = 'none';
      document.getElementById('user-info').style.display = 'none';

      setupNavigation();
      showPage('calendar');

      Swal.fire({
        icon: 'info',
        title: '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß',
        timer: 1500,
        showConfirmButton: false
      });
    }

    function getRoleDisplayName(role) {
      const roleNames = {
        'admin': '‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö',
        'hr': '‡∏ù‡πà‡∏≤‡∏¢‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•',
        'lead': '‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡∏°',
        'user': '‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ'
      };
      return roleNames[role] || '‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ';
    }

    function setupNavigation() {
      const navTabs = document.getElementById('nav-tabs');
      navTabs.innerHTML = '';

      let tabs = [];

      if (currentRole === 'admin' || currentRole === 'hr') {
        tabs = [
          { page: 'leave-request', label: 'üìù ‡∏Ç‡∏≠‡∏•‡∏≤‡∏á‡∏≤‡∏ô' },
          { page: 'daily', label: 'üìã ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' },
          { page: 'report', label: 'üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' },
          { page: 'calendar', label: 'üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏∞‡∏á‡∏≤‡∏ô' },
          { page: 'manage', label: 'üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô' },
          { page: 'profile', label: 'üìá Profile' },
          { page: 'warning', label: '‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' },
          { page: 'warning-report', label: 'üìë ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' }
        ];
      } else if (currentRole === 'lead') {
        tabs = [
          { page: 'leave-request', label: 'üìù ‡∏Ç‡∏≠‡∏•‡∏≤‡∏á‡∏≤‡∏ô' },
          { page: 'report', label: 'üìä ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô' },
          { page: 'calendar', label: 'üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏∞‡∏á‡∏≤‡∏ô' },
          { page: 'profile', label: 'üìá Profile' },
          { page: 'warning', label: '‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' },
          { page: 'warning-report', label: 'üìë ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô' }
        ];
      } else {
        tabs = [
          { page: 'leave-request', label: 'üìù ‡∏Ç‡∏≠‡∏•‡∏≤‡∏á‡∏≤‡∏ô' },
          { page: 'calendar', label: 'üìÖ ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏Å‡∏∞‡∏á‡∏≤‡∏ô' },
          { page: 'profile', label: 'üìá Profile' }
        ];
      }

      tabs.forEach(tab => {
        const button = document.createElement('button');
        button.className = 'nav-tab';
        button.textContent = tab.label;
        button.addEventListener('click', () => showPage(tab.page));
        navTabs.appendChild(button);
      });

      const adminShiftForm = document.getElementById('admin-shift-form');
      if (currentRole === 'admin' || currentRole === 'hr') {
        adminShiftForm.style.display = 'block';
      } else {
        adminShiftForm.style.display = 'none';
      }
    }

    function showPage(pageName) {
      document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
      document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));

      const page = document.getElementById(`page-${pageName}`);
      if (page) {
        page.classList.add('active');
        const tabs = document.querySelectorAll('.nav-tab');
        tabs.forEach((tab, index) => {
          if (tab.textContent.includes(page.querySelector('h2').textContent.substring(2))) {
            tab.classList.add('active');
          }
        });
      }

      refreshCurrentPage();
    }

    function refreshCurrentPage() {
      const activePage = document.querySelector('.page.active');
      if (!activePage) return;

      const pageId = activePage.id;
      
      switch(pageId) {
        case 'page-daily':
          renderDailyTable();
          break;
        case 'page-leave-request':
          renderCombinedPendingTable();
          break;
        case 'page-calendar':
          renderCalendar();
          break;
        case 'page-manage':
          renderEmployeeTable();
          populateManageEmployeeDropdown();
          break;
        case 'page-profile':
          populateProfileEmployeeDropdown();
          break;
        case 'page-warning':
          renderWarningTable();
          break;
      }

      updateEmployeeDropdowns();
    }

    function setTodayDates() {
      const today = new Date().toISOString().split('T')[0];
      const dateInputs = [
        'daily-date', 'shift-date-from', 'shift-date-to', 
        'leave-req-date-from', 'leave-req-date-to', 'warning-date',
        'profile-date-from', 'profile-date-to'
      ];
      dateInputs.forEach(id => {
        const input = document.getElementById(id);
        if (input) input.value = today;
      });
    }

    function setupEventHandlers() {
      document.getElementById('btn-save-daily').addEventListener('click', saveDailyRecord);
      document.getElementById('btn-save-shift').addEventListener('click', saveShift);
      document.getElementById('btn-save-leave-req').addEventListener('click', saveLeaveRequest);
      document.getElementById('btn-create-user').addEventListener('click', createUser);
      document.getElementById('btn-save-employee').addEventListener('click', saveEmployee);
      document.getElementById('btn-save-warning').addEventListener('click', saveWarning);
      document.getElementById('btn-generate-report').addEventListener('click', generateReport);
      document.getElementById('btn-generate-warning-report').addEventListener('click', generateWarningReport);
      document.getElementById('btn-load-profile').addEventListener('click', loadProfile);
      document.getElementById('btn-export-profile').addEventListener('click', exportProfile);
      
      document.getElementById('btn-open-daily-sheet').addEventListener('click', () => {
        window.open('https://docs.google.com/spreadsheets/d/189QK9csYj3yxLnlPqJdzuuSXUe_6681V_KZeT-LO0v4/edit#gid=0', '_blank', 'noopener,noreferrer');
      });
      
      document.getElementById('btn-open-warning-sheet').addEventListener('click', () => {
        window.open('https://docs.google.com/spreadsheets/d/189QK9csYj3yxLnlPqJdzuuSXUe_6681V_KZeT-LO0v4/edit#gid=1', '_blank', 'noopener,noreferrer');
      });
      
      document.getElementById('btn-open-shift-sheet').addEventListener('click', () => {
        window.open('https://docs.google.com/spreadsheets/d/189QK9csYj3yxLnlPqJdzuuSXUe_6681V_KZeT-LO0v4/edit#gid=2', '_blank', 'noopener,noreferrer');
      });
      
      document.getElementById('btn-load-daily-from-sheet').addEventListener('click', () => {
        Swal.fire({
          icon: 'info',
          title: '‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet',
          text: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó Attendance_Log',
          confirmButtonColor: '#d81b60'
        });
      });
      
      document.getElementById('btn-load-warning-from-sheet').addEventListener('click', () => {
        Swal.fire({
          icon: 'info',
          title: '‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet',
          text: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó Warnings_Log',
          confirmButtonColor: '#d81b60'
        });
      });
      
      document.getElementById('btn-load-shift-from-sheet').addEventListener('click', () => {
        Swal.fire({
          icon: 'info',
          title: '‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet',
          text: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó Shifts_Calendar',
          confirmButtonColor: '#d81b60'
        });
      });
      
      document.getElementById('btn-prev-month').addEventListener('click', () => {
        currentCalendarDate.setMonth(currentCalendarDate.getMonth() - 1);
        renderCalendar();
      });
      document.getElementById('btn-next-month').addEventListener('click', () => {
        currentCalendarDate.setMonth(currentCalendarDate.getMonth() + 1);
        renderCalendar();
      });
      document.getElementById('btn-today').addEventListener('click', () => {
        currentCalendarDate = new Date();
        renderCalendar();
      });
      
      ['daily', 'shift', 'leave-req', 'warning'].forEach(prefix => {
        const deptSelect = document.getElementById(`${prefix}-department`);
        if (deptSelect) {
          deptSelect.addEventListener('change', () => updateEmployeeDropdown(prefix));
        }
      });

      document.getElementById('calendar-filter-department').addEventListener('change', renderCalendar);
      document.getElementById('report-department').addEventListener('change', updateReportEmployeeDropdown);
      document.getElementById('report-mode').addEventListener('change', toggleReportEmployeeField);
      document.getElementById('warning-report-department').addEventListener('change', updateWarningReportEmployeeDropdown);
      document.getElementById('emp-fullname').addEventListener('change', autofillEmployeeData);
    }

    function toggleReportEmployeeField() {
      const mode = document.getElementById('report-mode').value;
      const employeeField = document.getElementById('report-employee-field');
      
      if (mode === 'individual') {
        employeeField.style.display = 'flex';
      } else {
        employeeField.style.display = 'none';
      }
    }

    function autofillEmployeeData() {
      const selectedName = document.getElementById('emp-fullname').value;
      if (!selectedName) {
        clearEmployeeForm();
        return;
      }

      const user = allRecords.find(r => r.type === 'user' && r.employee_fullname === selectedName);
      if (user) {
        currentEditingUserId = user.__backendId;
        document.getElementById('emp-nickname').value = user.nickname || '';
        document.getElementById('emp-department').value = user.department || '';
        document.getElementById('emp-username').value = user.username || '';
        document.getElementById('emp-password').value = user.password || '';
        document.getElementById('emp-position').value = user.position || '';
        document.getElementById('emp-birthday').value = user.birthday || '';
        document.getElementById('emp-dayoff').value = user.regular_dayoff || '';
        document.getElementById('emp-bank').value = user.bank_name || '';
        document.getElementById('emp-account').value = user.bank_account || '';
        document.getElementById('emp-email').value = user.email || '';
        document.getElementById('emp-address').value = user.address || '';
        document.getElementById('emp-emergency-contact').value = user.emergency_contact || '';
        document.getElementById('emp-emergency-relationship').value = user.emergency_relationship || '';
        document.getElementById('emp-emergency-phone').value = user.emergency_phone || '';
        document.getElementById('emp-photo').value = user.photo_url || '';
        document.getElementById('emp-idcard').value = user.id_card_url || '';
        document.getElementById('emp-application').value = user.application_url || '';
        document.getElementById('emp-contract').value = user.contract_url || '';
        document.getElementById('emp-startdate').value = user.start_date || '';
        document.getElementById('emp-status').value = user.work_status || '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà';
      }
    }

    function populateManageEmployeeDropdown() {
      const dropdown = document.getElementById('emp-fullname');
      const users = allRecords.filter(r => r.type === 'user');
      
      dropdown.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>';
      users.forEach(user => {
        const option = document.createElement('option');
        option.value = user.employee_fullname;
        option.textContent = user.employee_fullname;
        dropdown.appendChild(option);
      });
    }

    function populateProfileEmployeeDropdown() {
      const dropdown = document.getElementById('profile-employee');
      const users = allRecords.filter(r => r.type === 'user');
      
      dropdown.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>';
      
      users.forEach(user => {
        const option = document.createElement('option');
        option.value = user.nickname || user.employee_fullname;
        option.textContent = `${user.employee_fullname} (${user.nickname || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô'})`;
        dropdown.appendChild(option);
      });
    }

    function updateEmployeeDropdowns() {
      updateEmployeeDropdown('daily');
      updateEmployeeDropdown('shift');
      updateEmployeeDropdown('leave-req');
      updateEmployeeDropdown('warning');
      updateReportEmployeeDropdown();
      updateWarningReportEmployeeDropdown();
      populateManageEmployeeDropdown();
      populateProfileEmployeeDropdown();
    }

    function updateEmployeeDropdown(prefix) {
      const deptSelect = document.getElementById(`${prefix}-department`);
      const empSelect = document.getElementById(`${prefix}-employee`);
      if (!deptSelect || !empSelect) return;

      const selectedDept = deptSelect.value;
      const users = allRecords.filter(r => r.type === 'user' && r.department === selectedDept);

      empSelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</option>';
      
      users.forEach(user => {
        const option = document.createElement('option');
        option.value = user.nickname || user.employee_fullname;
        option.textContent = user.nickname || user.employee_fullname;
        empSelect.appendChild(option);
      });
    }

    function updateReportEmployeeDropdown() {
      const deptSelect = document.getElementById('report-department');
      const empSelect = document.getElementById('report-employee');
      if (!deptSelect || !empSelect) return;

      const selectedDept = deptSelect.value;
      let users = allRecords.filter(r => r.type === 'user');
      
      if (selectedDept) {
        users = users.filter(e => e.department === selectedDept);
      }

      empSelect.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</option>';
      
      users.forEach(user => {
        const option = document.createElement('option');
        option.value = user.nickname || user.employee_fullname;
        option.textContent = user.nickname || user.employee_fullname;
        empSelect.appendChild(option);
      });
    }

    function updateWarningReportEmployeeDropdown() {
      const deptSelect = document.getElementById('warning-report-department');
      const empSelect = document.getElementById('warning-report-employee');
      if (!deptSelect || !empSelect) return;

      const selectedDept = deptSelect.value;
      let users = allRecords.filter(r => r.type === 'user');
      
      if (selectedDept) {
        users = users.filter(e => e.department === selectedDept);
      }

      empSelect.innerHTML = '<option value="">‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</option>';
      
      users.forEach(user => {
        const option = document.createElement('option');
        option.value = user.nickname || user.employee_fullname;
        option.textContent = user.nickname || user.employee_fullname;
        empSelect.appendChild(option);
      });
    }

    async function sendToGoogleSheet(data) {
      try {
        const params = new URLSearchParams(data);
        await fetch(`${GOOGLE_SHEET_URL}?${params}`, {
          method: 'GET',
          mode: 'no-cors'
        });
        return true;
      } catch (error) {
        console.error('Error sending to Google Sheet:', error);
        return false;
      }
    }

    async function saveDailyRecord() {
      if (allRecords.length >= 999) {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
          text: '‡πÄ‡∏Å‡∏¥‡∏ô 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const record = {
        type: 'daily',
        date: document.getElementById('daily-date').value,
        status: document.getElementById('daily-status').value,
        leave_type: document.getElementById('daily-leave-type').value,
        approval: document.getElementById('daily-approval').value,
        shift: document.getElementById('daily-shift').value,
        time_recorded: document.getElementById('daily-time').value,
        late_minutes: parseInt(document.getElementById('daily-late').value) || 0,
        ot_minutes: parseInt(document.getElementById('daily-ot').value) || 0,
        department: document.getElementById('daily-department').value,
        employee_name: document.getElementById('daily-employee').value,
        general_note: document.getElementById('daily-note').value,
        id: Date.now().toString()
      };

      if (!record.date || !record.department || !record.employee_name) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const result = await window.dataSdk.create(record);

      if (result.isOk) {
        await sendToGoogleSheet({
          action: 'daily',
          ...record
        });

        Swal.fire({
          icon: 'success',
          title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          timer: 1500,
          showConfirmButton: false
        });
        
        clearDailyForm();
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: result.error.message,
          confirmButtonColor: '#d81b60'
        });
      }
    }

    function clearDailyForm() {
      document.getElementById('daily-department').value = '';
      document.getElementById('daily-employee').value = '';
      document.getElementById('daily-status').value = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô';
      document.getElementById('daily-leave-type').value = '';
      document.getElementById('daily-approval').value = '';
      document.getElementById('daily-shift').value = '8:00‚Äì17:00';
      document.getElementById('daily-time').value = '';
      document.getElementById('daily-late').value = '0';
      document.getElementById('daily-ot').value = '0';
      document.getElementById('daily-note').value = '';
    }

    function renderDailyTable() {
      const tbody = document.getElementById('daily-table-body');
      const dailyRecords = allRecords.filter(r => r.type === 'daily');

      if (dailyRecords.length === 0) {
        tbody.innerHTML = '<tr><td colspan="12" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
        return;
      }

      tbody.innerHTML = dailyRecords.map(record => `
        <tr>
          <td>${record.date || '-'}</td>
          <td>${record.status || '-'}</td>
          <td>${record.leave_type || '-'}</td>
          <td>${record.approval || '-'}</td>
          <td>${record.shift || '-'}</td>
          <td>${record.time_recorded || '-'}</td>
          <td>${record.late_minutes || 0}</td>
          <td>${record.ot_minutes || 0}</td>
          <td>${record.department || '-'}</td>
          <td>${record.employee_name || '-'}</td>
          <td>${record.general_note || '-'}</td>
          <td>
            <button class="btn-icon btn-delete" onclick="deleteDailyRecord('${record.__backendId}')">üóëÔ∏è</button>
          </td>
        </tr>
      `).join('');
    }

    window.deleteDailyRecord = async function(backendId) {
      const record = allRecords.find(r => r.__backendId === backendId);
      if (!record) return;

      const result = await Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
        text: '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d81b60',
        cancelButtonColor: '#f8bbd0',
        confirmButtonText: '‡∏•‡∏ö',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
      });

      if (result.isConfirmed) {
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });

        const deleteResult = await window.dataSdk.delete(record);
        
        if (deleteResult.isOk) {
          Swal.fire({
            icon: 'success',
            title: '‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            timer: 1500,
            showConfirmButton: false
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: deleteResult.error.message,
            confirmButtonColor: '#d81b60'
          });
        }
      }
    };

    async function saveShift() {
      if (allRecords.length >= 999) {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
          text: '‡πÄ‡∏Å‡∏¥‡∏ô 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const dateFrom = document.getElementById('shift-date-from').value;
      const dateTo = document.getElementById('shift-date-to').value;
      const department = document.getElementById('shift-department').value;
      const employee = document.getElementById('shift-employee').value;
      const shift = document.getElementById('shift-shift').value;
      const note = document.getElementById('shift-note').value;

      if (!dateFrom || !dateTo || !department || !employee) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const startDate = new Date(dateFrom);
      const endDate = new Date(dateTo);
      const dates = [];

      for (let d = new Date(startDate); d <= endDate; d.setDate(d.getDate() + 1)) {
        dates.push(new Date(d).toISOString().split('T')[0]);
      }

      for (const date of dates) {
        const record = {
          type: 'shift',
          date: date,
          date_from: dateFrom,
          date_to: dateTo,
          department: department,
          employee_name: employee,
          shift: shift,
          general_note: note,
          id: `${Date.now()}_${date}`.toString()
        };

        await window.dataSdk.create(record);
        
        await sendToGoogleSheet({
          action: 'shift',
          ...record
        });
      }

      Swal.fire({
        icon: 'success',
        title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏∞‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
        timer: 1500,
        showConfirmButton: false
      });

      document.getElementById('shift-department').value = '';
      document.getElementById('shift-employee').value = '';
      document.getElementById('shift-note').value = '';
    }

    async function saveLeaveRequest() {
      if (allRecords.length >= 999) {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
          text: '‡πÄ‡∏Å‡∏¥‡∏ô 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const dateFrom = document.getElementById('leave-req-date-from').value;
      const dateTo = document.getElementById('leave-req-date-to').value;
      const department = document.getElementById('leave-req-department').value;
      const employee = document.getElementById('leave-req-employee').value;
      const leaveType = document.getElementById('leave-req-type').value;
      const note = document.getElementById('leave-req-note').value;

      if (!dateFrom || !dateTo || !department || !employee) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const today = new Date();
      const leaveDate = new Date(dateFrom);
      const daysAdvance = Math.floor((leaveDate - today) / (1000 * 60 * 60 * 24));

      const record = {
        type: 'leave',
        date_from: dateFrom,
        date_to: dateTo,
        department: department,
        employee_name: employee,
        nickname: employee,
        leave_type: leaveType,
        leave_note: note,
        status: '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥',
        submit_date: new Date().toISOString().split('T')[0],
        days_advance: daysAdvance,
        id: Date.now().toString()
      };

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const result = await window.dataSdk.create(record);

      if (result.isOk) {
        await sendToGoogleSheet({
          action: 'leave',
          ...record
        });

        Swal.fire({
          icon: 'success',
          title: '‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          text: '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏à‡∏≤‡∏Å Lead ‡∏´‡∏£‡∏∑‡∏≠ HR',
          confirmButtonColor: '#d81b60'
        });

        document.getElementById('leave-req-department').value = '';
        document.getElementById('leave-req-employee').value = '';
        document.getElementById('leave-req-note').value = '';
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: result.error.message,
          confirmButtonColor: '#d81b60'
        });
      }
    }

    window.approveLeave = async function(backendId, status) {
      const record = allRecords.find(r => r.__backendId === backendId);
      if (!record) return;

      const { value: reason } = await Swal.fire({
        title: status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' ? '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤' : '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏•‡∏≤',
        input: 'textarea',
        inputLabel: '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°',
        inputPlaceholder: '‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏...',
        showCancelButton: true,
        confirmButtonColor: '#d81b60',
        cancelButtonColor: '#f8bbd0',
        confirmButtonText: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        inputValidator: (value) => {
          if (!value) {
            return '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏';
          }
        }
      });

      if (reason) {
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });

        const result = await window.dataSdk.update({ 
          ...record, 
          status,
          approval_reason: reason,
          approved_by: currentUsername || currentUser
        });

        if (result.isOk) {
          await sendToGoogleSheet({
            action: 'approve_leave',
            id: record.id,
            status: status,
            approval_reason: reason,
            approved_by: currentUsername || currentUser,
            employee_name: record.employee_name,
            date_from: record.date_from,
            date_to: record.date_to
          });

          Swal.fire({
            icon: 'success',
            title: status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' ? '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            timer: 1500,
            showConfirmButton: false
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: result.error.message,
            confirmButtonColor: '#d81b60'
          });
        }
      }
    };

    async function createUser() {
      if (allRecords.length >= 999) {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
          text: '‡πÄ‡∏Å‡∏¥‡∏ô 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const record = {
        type: 'user',
        username: document.getElementById('new-username').value.trim(),
        password: document.getElementById('new-password').value,
        employee_fullname: document.getElementById('new-fullname').value,
        nickname: document.getElementById('new-nickname').value,
        department: document.getElementById('new-department').value,
        birthday: document.getElementById('new-birthday').value,
        bank_name: document.getElementById('new-bank').value,
        bank_account: document.getElementById('new-account').value,
        email: document.getElementById('new-email').value,
        address: document.getElementById('new-address').value,
        emergency_contact: document.getElementById('new-emergency-contact').value,
        emergency_relationship: document.getElementById('new-emergency-relationship').value,
        emergency_phone: document.getElementById('new-emergency-phone').value,
        photo_url: document.getElementById('new-photo').value,
        role: 'user',
        id: Date.now().toString()
      };

      if (!record.username || !record.password || !record.employee_fullname) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Username, Password ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const existingUser = allRecords.find(r => r.type === 'user' && r.username === record.username);
      if (existingUser) {
        Swal.fire({
          icon: 'error',
          title: 'Username ‡∏ã‡πâ‡∏≥',
          text: 'Username ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏•‡πâ‡∏ß',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const result = await window.dataSdk.create(record);

      if (result.isOk) {
        await sendToGoogleSheet({
          action: 'create_user',
          ...record
        });

        Swal.fire({
          icon: 'success',
          title: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          text: `Username: ${record.username}`,
          confirmButtonColor: '#d81b60'
        });

        document.getElementById('new-username').value = '';
        document.getElementById('new-password').value = '';
        document.getElementById('new-fullname').value = '';
        document.getElementById('new-nickname').value = '';
        document.getElementById('new-birthday').value = '';
        document.getElementById('new-bank').value = '';
        document.getElementById('new-account').value = '';
        document.getElementById('new-email').value = '';
        document.getElementById('new-address').value = '';
        document.getElementById('new-emergency-contact').value = '';
        document.getElementById('new-emergency-relationship').value = '';
        document.getElementById('new-emergency-phone').value = '';
        document.getElementById('new-photo').value = '';
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: result.error.message,
          confirmButtonColor: '#d81b60'
        });
      }
    }

    async function saveEmployee() {
      if (!currentEditingUserId) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const user = allRecords.find(r => r.__backendId === currentEditingUserId);
      if (!user) {
        Swal.fire({
          icon: 'error',
          title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const updatedRecord = {
        ...user,
        nickname: document.getElementById('emp-nickname').value,
        department: document.getElementById('emp-department').value,
        username: document.getElementById('emp-username').value,
        password: document.getElementById('emp-password').value || user.password,
        position: document.getElementById('emp-position').value,
        birthday: document.getElementById('emp-birthday').value,
        regular_dayoff: document.getElementById('emp-dayoff').value,
        bank_name: document.getElementById('emp-bank').value,
        bank_account: document.getElementById('emp-account').value,
        email: document.getElementById('emp-email').value,
        address: document.getElementById('emp-address').value,
        emergency_contact: document.getElementById('emp-emergency-contact').value,
        emergency_relationship: document.getElementById('emp-emergency-relationship').value,
        emergency_phone: document.getElementById('emp-emergency-phone').value,
        photo_url: document.getElementById('emp-photo').value || user.photo_url,
        id_card_url: document.getElementById('emp-idcard').value,
        application_url: document.getElementById('emp-application').value,
        contract_url: document.getElementById('emp-contract').value,
        start_date: document.getElementById('emp-startdate').value,
        work_status: document.getElementById('emp-status').value
      };

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const result = await window.dataSdk.update(updatedRecord);

      if (result.isOk) {
        await sendToGoogleSheet({
          action: 'update_employee',
          ...updatedRecord
        });

        Swal.fire({
          icon: 'success',
          title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          timer: 1500,
          showConfirmButton: false
        });
        
        clearEmployeeForm();
        currentEditingUserId = null;
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: result.error.message,
          confirmButtonColor: '#d81b60'
        });
      }
    }

    function clearEmployeeForm() {
      document.getElementById('emp-fullname').value = '';
      document.getElementById('emp-nickname').value = '';
      document.getElementById('emp-department').value = '';
      document.getElementById('emp-username').value = '';
      document.getElementById('emp-password').value = '';
      document.getElementById('emp-position').value = '';
      document.getElementById('emp-birthday').value = '';
      document.getElementById('emp-dayoff').value = '';
      document.getElementById('emp-bank').value = '';
      document.getElementById('emp-account').value = '';
      document.getElementById('emp-email').value = '';
      document.getElementById('emp-address').value = '';
      document.getElementById('emp-emergency-contact').value = '';
      document.getElementById('emp-emergency-relationship').value = '';
      document.getElementById('emp-emergency-phone').value = '';
      document.getElementById('emp-photo').value = '';
      document.getElementById('emp-idcard').value = '';
      document.getElementById('emp-application').value = '';
      document.getElementById('emp-contract').value = '';
      document.getElementById('emp-startdate').value = '';
      document.getElementById('emp-status').value = '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà';
    }

    function renderEmployeeTable() {
      const tbody = document.getElementById('employee-table-body');
      const users = allRecords.filter(r => r.type === 'user');

      if (users.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</td></tr>';
        return;
      }

      tbody.innerHTML = users.map(user => `
        <tr>
          <td>${user.employee_fullname || '-'}</td>
          <td>${user.nickname || '-'}</td>
          <td>${user.department || '-'}</td>
          <td>${user.position || '-'}</td>
          <td>${user.birthday || '-'}</td>
          <td style="color: ${user.work_status === '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà' ? '#2e7d32' : '#c62828'}; font-weight: 600;">${user.work_status || '‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà'}</td>
          <td>
            <button class="btn-icon btn-delete" onclick="deleteEmployee('${user.__backendId}')">üóëÔ∏è</button>
          </td>
        </tr>
      `).join('');
    }

    window.deleteEmployee = async function(backendId) {
      const record = allRecords.find(r => r.__backendId === backendId);
      if (!record) return;

      const result = await Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
        text: '‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d81b60',
        cancelButtonColor: '#f8bbd0',
        confirmButtonText: '‡∏•‡∏ö',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
      });

      if (result.isConfirmed) {
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });

        const deleteResult = await window.dataSdk.delete(record);
        
        if (deleteResult.isOk) {
          Swal.fire({
            icon: 'success',
            title: '‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            timer: 1500,
            showConfirmButton: false
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: deleteResult.error.message,
            confirmButtonColor: '#d81b60'
          });
        }
      }
    };

    function loadProfile() {
      const employeeName = document.getElementById('profile-employee').value;
      const dateFrom = document.getElementById('profile-date-from').value;
      const dateTo = document.getElementById('profile-date-to').value;

      if (!employeeName) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const user = allRecords.find(r => r.type === 'user' && (r.nickname === employeeName || r.employee_fullname === employeeName));
      
      if (!user) {
        Swal.fire({
          icon: 'error',
          title: '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      document.getElementById('profile-content').style.display = 'block';
      
      const profilePhoto = document.getElementById('profile-photo');
      profilePhoto.src = user.photo_url || 'https://via.placeholder.com/150?text=No+Photo';
      profilePhoto.onerror = function() {
        this.src = 'https://via.placeholder.com/150?text=No+Photo';
      };

      document.getElementById('profile-name').textContent = user.employee_fullname || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
      document.getElementById('profile-dept').textContent = user.department || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
      document.getElementById('profile-pos').textContent = user.position || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
      document.getElementById('profile-bday').textContent = user.birthday || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
      document.getElementById('profile-start').textContent = user.start_date || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';

      const timeline = document.getElementById('profile-timeline');
      timeline.innerHTML = '';

      const employeeRecords = allRecords.filter(r => {
        if (!dateFrom || !dateTo) return false;
        
        const recordDate = r.date || r.submit_date || r.start_date;
        if (!recordDate) return false;
        
        return (r.employee_name === employeeName || r.employee_name === user.employee_fullname || r.nickname === employeeName) &&
               recordDate >= dateFrom && recordDate <= dateTo;
      });

      if (employeeRecords.length === 0) {
        timeline.innerHTML = '<div class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Timeline ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</div>';
        return;
      }

      employeeRecords.sort((a, b) => {
        const dateA = a.date || a.submit_date || a.start_date;
        const dateB = b.date || b.submit_date || b.start_date;
        return new Date(dateB) - new Date(dateA);
      });

      employeeRecords.forEach(record => {
        const item = document.createElement('div');
        item.className = 'timeline-item';

        let typeLabel = '';
        let content = '';

        if (record.type === 'daily') {
          typeLabel = '‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô';
          content = `<strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${record.status || '-'} | <strong>‡∏Å‡∏∞:</strong> ${record.shift || '-'} | <strong>‡∏™‡∏≤‡∏¢:</strong> ${record.late_minutes || 0} ‡∏ô‡∏≤‡∏ó‡∏µ | <strong>OT:</strong> ${record.ot_minutes || 0} ‡∏ô‡∏≤‡∏ó‡∏µ`;
        } else if (record.type === 'leave') {
          typeLabel = '‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏á‡∏≤‡∏ô';
          content = `<strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${record.leave_type || '-'} | <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${record.status || '-'} | <strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:</strong> ${record.leave_note || '-'}`;
        } else if (record.type === 'warning') {
          typeLabel = '‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô';
          content = `<strong>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á:</strong> ${record.warning_subject || '-'} | <strong>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î:</strong> ${record.warning_detail || '-'} | <strong>‡∏ï‡∏±‡∏Å‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÇ‡∏î‡∏¢:</strong> ${record.warned_by || '-'}`;
        }

        const recordDate = record.date || record.submit_date || record.start_date;

        item.innerHTML = `
          <div class="timeline-type">${typeLabel}</div>
          <div style="color: #d81b60; font-weight: 700; margin-bottom: 8px;">${recordDate}</div>
          <div style="color: #333;">${content}</div>
        `;

        timeline.appendChild(item);
      });

      if (currentRole === 'admin' || currentRole === 'hr') {
        document.getElementById('btn-export-profile').style.display = 'inline-block';
      }
    }

    function exportProfile() {
      Swal.fire({
        icon: 'info',
        title: 'Export to Google Sheet',
        text: '‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Export ‡∏à‡∏∞‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Profile ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Google Sheet',
        confirmButtonColor: '#d81b60'
      });

      const employeeName = document.getElementById('profile-employee').value;
      const dateFrom = document.getElementById('profile-date-from').value;
      const dateTo = document.getElementById('profile-date-to').value;

      sendToGoogleSheet({
        action: 'export_profile',
        employee_name: employeeName,
        date_from: dateFrom,
        date_to: dateTo,
        exported_by: currentUser
      });
    }

    async function saveWarning() {
      if (allRecords.length >= 999) {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î',
          text: '‡πÄ‡∏Å‡∏¥‡∏ô 999 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      const record = {
        type: 'warning',
        date: document.getElementById('warning-date').value,
        department: document.getElementById('warning-department').value,
        employee_name: document.getElementById('warning-employee').value,
        warning_subject: document.getElementById('warning-subject').value,
        warning_detail: document.getElementById('warning-detail').value,
        warned_by: document.getElementById('warning-by').value,
        id: Date.now().toString()
      };

      if (!record.date || !record.department || !record.employee_name || !record.warning_subject) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...',
        allowOutsideClick: false,
        didOpen: () => {
          Swal.showLoading();
        }
      });

      const result = await window.dataSdk.create(record);

      if (result.isOk) {
        await sendToGoogleSheet({
          action: 'warning',
          ...record
        });

        Swal.fire({
          icon: 'success',
          title: '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
          timer: 1500,
          showConfirmButton: false
        });
        
        clearWarningForm();
      } else {
        Swal.fire({
          icon: 'error',
          title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
          text: result.error.message,
          confirmButtonColor: '#d81b60'
        });
      }
    }

    function clearWarningForm() {
      document.getElementById('warning-department').value = '';
      document.getElementById('warning-employee').value = '';
      document.getElementById('warning-subject').value = '';
      document.getElementById('warning-detail').value = '';
      document.getElementById('warning-by').value = '';
    }

    function renderWarningTable() {
      const tbody = document.getElementById('warning-table-body');
      const warnings = allRecords.filter(r => r.type === 'warning');

      if (warnings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
        return;
      }

      tbody.innerHTML = warnings.map(record => `
        <tr>
          <td>${record.date || '-'}</td>
          <td>${record.department || '-'}</td>
          <td>${record.employee_name || '-'}</td>
          <td>${record.warning_subject || '-'}</td>
          <td>${record.warning_detail || '-'}</td>
          <td>${record.warned_by || '-'}</td>
          <td>
            <button class="btn-icon btn-delete" onclick="deleteWarning('${record.__backendId}')">üóëÔ∏è</button>
          </td>
        </tr>
      `).join('');
    }

    window.deleteWarning = async function(backendId) {
      const record = allRecords.find(r => r.__backendId === backendId);
      if (!record) return;

      const result = await Swal.fire({
        title: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö',
        text: '‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#d81b60',
        cancelButtonColor: '#f8bbd0',
        confirmButtonText: '‡∏•‡∏ö',
        cancelButtonText: '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
      });

      if (result.isConfirmed) {
        Swal.fire({
          title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏ö...',
          allowOutsideClick: false,
          didOpen: () => {
            Swal.showLoading();
          }
        });

        const deleteResult = await window.dataSdk.delete(record);
        
        if (deleteResult.isOk) {
          Swal.fire({
            icon: 'success',
            title: '‡∏•‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
            timer: 1500,
            showConfirmButton: false
          });
        } else {
          Swal.fire({
            icon: 'error',
            title: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
            text: deleteResult.error.message,
            confirmButtonColor: '#d81b60'
          });
        }
      }
    };

    function generateReport() {
      const dateFrom = document.getElementById('report-date-from').value;
      const dateTo = document.getElementById('report-date-to').value;
      const mode = document.getElementById('report-mode').value;
      const department = document.getElementById('report-department').value;
      const employee = document.getElementById('report-employee').value;

      if (!dateFrom || !dateTo) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      let dailyRecords = allRecords.filter(r => 
        r.type === 'daily' && 
        r.date >= dateFrom && 
        r.date <= dateTo
      );

      if (department) {
        dailyRecords = dailyRecords.filter(r => r.department === department);
      }

      if (employee) {
        dailyRecords = dailyRecords.filter(r => r.employee_name === employee);
      }

      const tbody = document.getElementById('report-table-body');
      const thead = document.getElementById('report-table-head');

      if (mode === 'department') {
        thead.innerHTML = `
          <tr>
            <th>‡∏ä‡∏∑‡πà‡∏≠‡∏û‡∏ô‡∏±‡∏Å‡∏á‡∏≤‡∏ô</th>
            <th>‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô(‡∏ß‡∏±‡∏ô)</th>
            <th>OT(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
            <th>‡∏™‡∏≤‡∏¢(‡∏ô‡∏≤‡∏ó‡∏µ)</th>
            <th>‡∏•‡∏≤‡∏Å‡∏¥‡∏à(‡∏ß‡∏±‡∏ô)</th>
            <th>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢(‡∏ß‡∏±‡∏ô)</th>
            <th>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô(‡∏ß‡∏±‡∏ô)</th>
            <th>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</th>
            <th>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
            <th>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</th>
          </tr>
        `;

        const employeeStats = {};

        dailyRecords.forEach(record => {
          const name = record.employee_name;
          if (!employeeStats[name]) {
            employeeStats[name] = {
              workDays: 0,
              otMinutes: 0,
              lateMinutes: 0,
              personalLeave: 0,
              sickLeave: 0,
              vacationLeave: 0,
              absent: 0,
              approved: 0,
              rejected: 0
            };
          }

          if (record.status === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô') employeeStats[name].workDays++;
          if (record.ot_minutes) employeeStats[name].otMinutes += (record.ot_minutes || 0);
          if (record.late_minutes > 0) employeeStats[name].lateMinutes += record.late_minutes;
          if (record.leave_type === '‡∏•‡∏≤‡∏Å‡∏¥‡∏à') employeeStats[name].personalLeave++;
          if (record.leave_type === '‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢') employeeStats[name].sickLeave++;
          if (record.leave_type === '‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô') employeeStats[name].vacationLeave++;
          if (record.approval === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß') employeeStats[name].approved++;
          if (record.approval === '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô') employeeStats[name].rejected++;
        });

        if (Object.keys(employeeStats).length === 0) {
          tbody.innerHTML = '<tr><td colspan="10" class="empty-state">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</td></tr>';
          return;
        }

        tbody.innerHTML = Object.entries(employeeStats).map(([name, stats]) => `
          <tr>
            <td>${name}</td>
            <td>${stats.workDays}</td>
            <td>${stats.otMinutes}</td>
            <td>${stats.lateMinutes}</td>
            <td>${stats.personalLeave}</td>
            <td>${stats.sickLeave}</td>
            <td>${stats.vacationLeave}</td>
            <td>${stats.absent}</td>
            <td>${stats.approved}</td>
            <td>${stats.rejected}</td>
          </tr>
        `).join('');
      } else {
        thead.innerHTML = `
          <tr>
            <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
            <th>‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</th>
            <th>‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô</th>
            <th>OT</th>
            <th>‡∏™‡∏≤‡∏¢</th>
            <th>‡∏•‡∏≤‡∏Å‡∏¥‡∏à</th>
            <th>‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</th>
            <th>‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô</th>
            <th>‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</th>
            <th>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</th>
            <th>‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô</th>
          </tr>
        `;

        if (dailyRecords.length === 0) {
          tbody.innerHTML = '<tr><td colspan="11" class="empty-state">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</td></tr>';
          return;
        }

        tbody.innerHTML = dailyRecords.map(record => `
          <tr>
            <td>${record.date || '-'}</td>
            <td>${record.status === '‡πÄ‡∏Ç‡πâ‡∏≤‡∏á‡∏≤‡∏ô' ? '‚úÖ' : '-'}</td>
            <td>${record.time_recorded || '-'}</td>
            <td>${record.ot_minutes > 0 ? record.ot_minutes + ' ‡∏ô‡∏≤‡∏ó‡∏µ' : '-'}</td>
            <td>${record.late_minutes > 0 ? record.late_minutes + ' ‡∏ô‡∏≤‡∏ó‡∏µ' : '-'}</td>
            <td>${record.leave_type === '‡∏•‡∏≤‡∏Å‡∏¥‡∏à' ? '‚úÖ' : '-'}</td>
            <td>${record.leave_type === '‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢' ? '‚úÖ' : '-'}</td>
            <td>${record.leave_type === '‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏£‡πâ‡∏≠‡∏ô' ? '‚úÖ' : '-'}</td>
            <td>-</td>
            <td>${record.approval === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß' ? '‚úÖ' : '-'}</td>
            <td>${record.approval === '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô' ? '‚úÖ' : '-'}</td>
          </tr>
        `).join('');
      }
    }

    function generateWarningReport() {
      const dateFrom = document.getElementById('warning-report-date-from').value;
      const dateTo = document.getElementById('warning-report-date-to').value;
      const department = document.getElementById('warning-report-department').value;
      const employee = document.getElementById('warning-report-employee').value;

      if (!dateFrom || !dateTo) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà',
          confirmButtonColor: '#d81b60'
        });
        return;
      }

      let warnings = allRecords.filter(r => 
        r.type === 'warning' && 
        r.date >= dateFrom && 
        r.date <= dateTo
      );

      if (department) {
        warnings = warnings.filter(r => r.department === department);
      }

      if (employee) {
        warnings = warnings.filter(r => r.employee_name === employee);
      }

      const tbody = document.getElementById('warning-report-table-body');

      if (warnings.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="empty-state">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</td></tr>';
        return;
      }

      tbody.innerHTML = warnings.map(w => `
        <tr>
          <td>${w.employee_name || '-'}</td>
          <td>${w.date || '-'}</td>
          <td>${w.warning_subject || '-'}</td>
          <td>${w.warning_detail || '-'}</td>
          <td>${w.warned_by || '-'}</td>
        </tr>
      `).join('');
    }

    function renderCalendar() {
      const year = currentCalendarDate.getFullYear();
      const month = currentCalendarDate.getMonth();
      
      const monthNames = ['‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå', '‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°', '‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô', '‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°', '‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô',
                          '‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°', '‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°', '‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô', '‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', '‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', '‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°'];
      
      document.getElementById('calendar-month-year').textContent = `${monthNames[month]} ${year + 543}`;
      
      const firstDay = new Date(year, month, 1).getDay();
      const daysInMonth = new Date(year, month + 1, 0).getDate();
      
      const filterDept = document.getElementById('calendar-filter-department').value;
      
      const grid = document.getElementById('calendar-grid');
      grid.innerHTML = '';
      
      const dayNames = ['‡∏≠‡∏≤', '‡∏à', '‡∏≠', '‡∏û', '‡∏û‡∏§', '‡∏®', '‡∏™'];
      dayNames.forEach(day => {
        const header = document.createElement('div');
        header.className = 'calendar-day-header';
        header.textContent = day;
        grid.appendChild(header);
      });
      
      for (let i = 0; i < firstDay; i++) {
        const emptyDay = document.createElement('div');
        emptyDay.className = 'calendar-day';
        grid.appendChild(emptyDay);
      }
      
      for (let day = 1; day <= daysInMonth; day++) {
        const dayCell = document.createElement('div');
        dayCell.className = 'calendar-day';
        
        const dayNumber = document.createElement('div');
        dayNumber.className = 'calendar-day-number';
        dayNumber.textContent = day;
        dayCell.appendChild(dayNumber);
        
        const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        
        let dayRecords = allRecords.filter(r => {
          if (r.type === 'shift' && r.date === dateStr) return true;
          if (r.type === 'leave' && r.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß') {
            const from = new Date(r.date_from);
            const to = new Date(r.date_to);
            const current = new Date(dateStr);
            return current >= from && current <= to;
          }
          return false;
        });
        
        if (filterDept) {
          dayRecords = dayRecords.filter(r => r.department === filterDept);
        }
        
        dayRecords.forEach(record => {
          const event = document.createElement('div');
          event.className = 'calendar-event';
          
          if (record.type === 'shift') {
            event.classList.add('shift');
            event.textContent = `${record.employee_name}: ${record.shift}`;
          } else if (record.type === 'leave') {
            event.classList.add('leave');
            event.textContent = `${record.employee_name}: ${record.leave_type}`;
            event.addEventListener('click', () => {
              Swal.fire({
                title: '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏•‡∏≤',
                html: `
                  <div style="text-align: left;">
                    <p><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${record.employee_name}</p>
                    <p><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${record.leave_type}</p>
                    <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${record.date_from} ‡∏ñ‡∏∂‡∏á ${record.date_to}</p>
                    <p><strong>‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•:</strong> ${record.leave_note || '-'}</p>
                    <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> ${record.status}</p>
                    <p><strong>‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÇ‡∏î‡∏¢:</strong> ${record.approved_by || '-'}</p>
                  </div>
                `,
                confirmButtonColor: '#d81b60'
              });
            });
          }
          
          dayCell.appendChild(event);
        });
        
        grid.appendChild(dayCell);
      }
      
      renderCalendarSummaryTable();
    }

    function renderCalendarSummaryTable() {
      const tbody = document.getElementById('calendar-summary-table');
      const year = currentCalendarDate.getFullYear();
      const month = currentCalendarDate.getMonth();
      
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      
      const filterDept = document.getElementById('calendar-filter-department').value;
      
      let records = allRecords.filter(r => {
        if (r.type === 'shift') {
          const recordDate = new Date(r.date);
          return recordDate >= firstDay && recordDate <= lastDay;
        }
        if (r.type === 'leave' && r.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß') {
          const from = new Date(r.date_from);
          const to = new Date(r.date_to);
          return (from <= lastDay && to >= firstDay);
        }
        return false;
      });
      
      if (filterDept) {
        records = records.filter(r => r.department === filterDept);
      }
      
      if (records.length === 0) {
        tbody.innerHTML = '<tr><td colspan="7" class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>';
        return;
      }
      
      const rows = [];
      
      records.forEach(record => {
        if (record.type === 'shift') {
          rows.push({
            date: record.date,
            employee: record.employee_name,
            shift: record.shift,
            leaveType: '-',
            leaveDates: '-',
            approvedBy: '-',
            note: record.general_note || '-'
          });
        } else if (record.type === 'leave') {
          rows.push({
            date: record.date_from,
            employee: record.employee_name,
            shift: '-',
            leaveType: record.leave_type,
            leaveDates: `${record.date_from} ‚Äì ${record.date_to}`,
            approvedBy: record.approved_by || '-',
            note: record.leave_note || '-'
          });
        }
      });
      
      rows.sort((a, b) => new Date(a.date) - new Date(b.date));
      
      tbody.innerHTML = rows.map(row => `
        <tr>
          <td>${row.date}</td>
          <td>${row.employee}</td>
          <td>${row.shift}</td>
          <td>${row.leaveType}</td>
          <td>${row.leaveDates}</td>
          <td>${row.approvedBy}</td>
          <td>${row.note}</td>
        </tr>
      `).join('');
    }

    function renderCombinedPendingTable() {
      const tbody = document.getElementById('combined-pending-table');
      const leaveRecords = allRecords.filter(r => r.type === 'leave');
      const isAdminRole = currentRole === 'admin' || currentRole === 'hr' || currentRole === 'lead';

      const header = document.getElementById('approval-actions-header');
      if (header) {
        header.style.display = isAdminRole ? '' : 'none';
      }

      if (leaveRecords.length === 0) {
        tbody.innerHTML = '<tr><td colspan="9" class="empty-state">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</td></tr>';
        return;
      }

      tbody.innerHTML = leaveRecords.map(record => {
        let statusBadge = '';
        if (record.status === '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥') {
          statusBadge = '<span class="status-badge status-pending">‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>';
        } else if (record.status === '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß') {
          statusBadge = '<span class="status-badge status-approved">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</span>';
        } else if (record.status === '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥') {
          statusBadge = '<span class="status-badge status-rejected">‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</span>';
        }

        const actionsCell = isAdminRole && record.status === '‡∏£‡∏≠‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥' ? `
          <td>
            <button class="btn-icon btn-approve" onclick="approveLeave('${record.__backendId}', '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß')">‚úÖ ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
            <button class="btn-icon btn-reject" onclick="approveLeave('${record.__backendId}', '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥')">‚ùå ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥</button>
          </td>
        ` : (isAdminRole ? '<td>-</td>' : '');

        return `
          <tr>
            <td>${record.nickname || record.employee_name || '-'}</td>
            <td>${record.department || '-'}</td>
            <td>${record.submit_date || '-'}</td>
            <td>${record.date_from || '-'}</td>
            <td>${record.date_to || '-'}</td>
            <td>${record.days_advance || 0} ‡∏ß‡∏±‡∏ô</td>
            <td>${record.leave_note || '-'}</td>
            <td>${statusBadge}</td>
            ${actionsCell}
          </tr>
        `;
      }).join('');
    }

    init();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9ae57fb5026f4b52',t:'MTc2NTc5NzA3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>

